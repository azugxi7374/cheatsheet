<!-- open this html with browser -->
<div id="dom-content-1">content before script tag.</div>

<div id="dom-content-2">
    <!-- <img src="http://localhost:8125/dummy.jpg" /> -->
    <img
        src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVQI12NgYAAAAAMAASDVlMcAAAAASUVORK5CYII=" />
    <img src="./simple_image.png" />
</div>

<script>
    // const dummyServer = `http://localhost:8125`

    console.log("[script start] state = ", document.readyState) // loading

    const now = Date.now();
    document.addEventListener('DOMContentLoaded', (e) => {
        console.log("[DOMContentLoaded] state = ", document.readyState) // interactive
    })
    document.addEventListener('readystatechange', (e) => {
        console.log("[readystatechange] state = ", document.readyState) // interactive -> complete
    });

    // 同期の長い処理
    console.log("sync sleeping 3sec...")
    while (Date.now() < now + 3 * 1000) { }

    // 非同期の長い処理
    const p = new Promise((res, rej) => {
        const stateBefore = document.readyState
        console.log("[in promise constructor]", document.readyState, "async sleeping...")
        setTimeout(() => res(), 3 * 1000)
    }).then(stateBefore => {
        const stateAfter = document.readyState
        console.log("[after async sleep]", stateAfter)
    })

    const documents = document.body.innerHTML
    console.log("body = ", documents)

    const dc1 = document.querySelector('#dom-content-1')
    const dc3 = document.querySelector('#dom-content-3')
    console.log("dc1 = ", dc1, "dc3 = ", dc3)

    console.log("[end of script]. state = ", document.readyState) // loading

    // document.body.innerHTML += `<div id="dom-content-4>content added by script1</div>"`
    const div4 = document.createElement('div'); div4.id = "dom-content-4";
    div4.textContent = "content added by script1"
    document.body.appendChild(div4)

</script>

<div id="dom-content-3">content after script tag. </div>

<script>
    console.log("script 2")
</script>